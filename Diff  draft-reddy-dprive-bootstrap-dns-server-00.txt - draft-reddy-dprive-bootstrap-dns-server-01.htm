<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by rfcdiff 1.47: rfcdiff  -->
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux zinfandel 3.2.0-5-amd64 #1 SMP Debian 3.2.96-3 x86_64 GNU/Linux -->
<!-- Using awk: /usr/bin/gawk: GNU Awk 4.0.1 -->
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.2 -->
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.1.2 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta http-equiv="Content-Style-Type" content="text/css"> 
  <title>Diff: draft-reddy-dprive-bootstrap-dns-server-00.txt - draft-reddy-dprive-bootstrap-dns-server-01.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.replace("#" + new_str)
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
<style>@media print {#ghostery-purple-box {display:none !important}}</style></head> 
<body> 
  <table cellspacing="0" cellpadding="0" border="0"> 
  <tbody><tr id="part-1" bgcolor="orange"><th></th><th><a href="https://tools.ietf.org/rfcdiff?url2=draft-reddy-dprive-bootstrap-dns-server-00.txt" style="color:#008; text-decoration:none;">&lt;</a>&nbsp;<a href="https://tools.ietf.org/html/draft-reddy-dprive-bootstrap-dns-server-00.txt" style="color:#008">draft-reddy-dprive-bootstrap-dns-server-00.txt</a>&nbsp;</th><th> </th><th>&nbsp;<a href="https://tools.ietf.org/html/draft-reddy-dprive-bootstrap-dns-server-01.txt" style="color:#008">draft-reddy-dprive-bootstrap-dns-server-01.txt</a>&nbsp;<a href="https://tools.ietf.org/rfcdiff?url1=draft-reddy-dprive-bootstrap-dns-server-01.txt" style="color:#008; text-decoration:none;">&gt;</a></th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-1" class="change"><td></td><th><small>skipping to change at</small><a href="#part-1"><em> page 1, line 15<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-1"><em> page 1, line 15<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">Intended status: Standards Track                                 D. Wing</td><td> </td><td class="right">Intended status: Standards Track                                 D. Wing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Expires: September 6, 2019</td><td> </td><td class="right">Expires: September 6, 2019</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                           M. Richardson</td><td> </td><td class="right">                                                           M. Richardson</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                Sandelman Software Works</td><td> </td><td class="right">                                                Sandelman Software Works</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                            M. Boucadair</td><td> </td><td class="right">                                                            M. Boucadair</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                                  Orange</td><td> </td><td class="right">                                                                  Orange</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                           March 5, 2019</td><td> </td><td class="right">                                                           March 5, 2019</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"> A Bootstrapping Procedure to Discover and Authenticate DNS-over-(D)TLS</td><td> </td><td class="right"> A Bootstrapping Procedure to Discover and Authenticate DNS-over-(D)TLS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                       and DNS-over-HTTPS Servers</td><td> </td><td class="right">                       and DNS-over-HTTPS Servers</td><td class="lineno"></td></tr>
      <tr id="diff0001"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">               draft-reddy-dprive-bootstrap-dns-server-0<span class="delete">0</span></td><td> </td><td class="rblock">               draft-reddy-dprive-bootstrap-dns-server-0<span class="insert">1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document specifies mechanisms to automatically bootstrap</td><td> </td><td class="right">   This document specifies mechanisms to automatically bootstrap</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoints (e.g., hosts, Customer Equipment) to discover and</td><td> </td><td class="right">   endpoints (e.g., hosts, Customer Equipment) to discover and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticate DNS-over-(D)TLS and DNS-over-HTTPS servers provided by a</td><td> </td><td class="right">   authenticate DNS-over-(D)TLS and DNS-over-HTTPS servers provided by a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   local network.</td><td> </td><td class="right">   local network.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-2" class="change"><td></td><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 13<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 13<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   publication of this document.  Please review these documents</td><td> </td><td class="right">   publication of this document.  Please review these documents</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   carefully, as they describe your rights and restrictions with respect</td><td> </td><td class="right">   carefully, as they describe your rights and restrictions with respect</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to this document.  Code Components extracted from this document must</td><td> </td><td class="right">   to this document.  Code Components extracted from this document must</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   include Simplified BSD License text as described in Section 4.e of</td><td> </td><td class="right">   include Simplified BSD License text as described in Section 4.e of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the Trust Legal Provisions and are provided without warranty as</td><td> </td><td class="right">   the Trust Legal Provisions and are provided without warranty as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in the Simplified BSD License.</td><td> </td><td class="right">   described in the Simplified BSD License.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2</td><td> </td><td class="right">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2</td><td class="lineno"></td></tr>
      <tr id="diff0002"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   2.  <span class="delete">Requirements Language</span> . . . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="rblock">   2.  <span class="insert">Terminology . . . . .</span> . . . . . . . . . . . . . . . . . . . .   4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   3.  Bootstrapping IoT Devices and CPE . . . . . . . . . . . . . .   4</td><td> </td><td class="right">   3.  Bootstrapping IoT Devices and CPE . . . . . . . . . . . . . .   4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   4.  Bootstrapping Endpoint Devices  . . . . . . . . . . . . . . .   5</td><td> </td><td class="right">   4.  Bootstrapping Endpoint Devices  . . . . . . . . . . . . . . .   5</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   5.  Discovery Procedure . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">   5.  Discovery Procedure . . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"></td></tr>
      <tr id="diff0003"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     5.1.  <span class="delete">DNS Reference Identifier DHCP Options . . . . . . . . . .   6</span></td><td> </td><td class="rblock">     5.1.  <span class="insert">Resolution</span>  . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       5.1.1.  DHCPv6 DNS Reference Identifier Option  .</span> . . . . . .   <span class="delete">7</span></td><td> </td><td class="rblock"><span class="insert">   6.  Connection handshake and service invocation</span> . . . . . . . . .   8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       5.1.2.  DHCPv4 DNS Reference Identifier Option</span>  . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">   <span class="insert">7.</span>  Security Considerations . . . . . . . . . . . . . . . . . . .   <span class="insert">8</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     5.2.  Resolution  . . . .</span> . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="rblock"><span class="insert">   8.</span>  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">6.</span>  Security Considerations . . . . . . . . . . . . . . . . . . .   <span class="delete">9</span></td><td> </td><td class="rblock">     <span class="insert">8.1.</span>  Application Service &amp; Application Protocol Tags . . . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   7.</span>  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="rblock"><span class="insert">       8.1.1.</span>  DNS Application Service Tag Registration  . . . . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">7.1.  DHCPv6 Option . . . . . . . . . . . . . . . . . . . . . .   9</span></td><td> </td><td class="rblock"><span class="insert">       8.1.2.</span>  dns.tls Application Protocol Tag Registration . . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     7.2.  DHCPv4 Option . . . . . . . . . . . . . . . . . . . . . .  10</span></td><td> </td><td class="rblock"><span class="insert">       8.1.3.</span>  dns.dtls Application Protocol Tag Registration  . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     7.3.</span>  Application Service &amp; Application Protocol Tags . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock"><span class="insert">       8.1.4.</span>  dns.https Application Protocol Tag Registration . . .  10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.1.</span>  DNS Application Service Tag Registration  . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock">   <span class="insert">9.</span>  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.2.</span>  dns.tls Application Protocol Tag Registration . . . .  <span class="delete">10</span></td><td> </td><td class="rblock"><span class="insert">   10.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.3.</span>  dns.dtls Application Protocol Tag Registration  . . .  <span class="delete">10</span></td><td> </td><td class="rblock"><span class="insert">     10.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       7.3.4.</span>  dns.https Application Protocol Tag Registration . . .  10</td><td> </td><td class="rblock"><span class="insert">     10.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">8.</span>  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   9.</span>  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     9.1.</span>  Normative References  . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     9.2.</span>  Informative References  . . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Various network security services are provided by Enterprise, secure</td><td> </td><td class="right">   Various network security services are provided by Enterprise, secure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   home and wall-gardened networks to protect endpoints (e.g,. hosts,</td><td> </td><td class="right">   home and wall-gardened networks to protect endpoints (e.g,. hosts,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IoT devices).  Some of these security services act on DNS requests</td><td> </td><td class="right">   IoT devices).  Some of these security services act on DNS requests</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   from endpoints.  However, if an endpoint is configured to use public</td><td> </td><td class="right">   from endpoints.  However, if an endpoint is configured to use public</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   DNS-over-(D)TLS [RFC7858] [RFC8094] or DNS-over-HTTPS [RFC8484]</td><td> </td><td class="right">   DNS-over-(D)TLS [RFC7858] [RFC8094] or DNS-over-HTTPS [RFC8484]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   servers, network security services in the local network cannot act</td><td> </td><td class="right">   servers, network security services in the local network cannot act</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   efficiently on DNS requests from the endpoints.  In order to act on</td><td> </td><td class="right">   efficiently on DNS requests from the endpoints.  In order to act on</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-3" class="change"><td></td><th><small>skipping to change at</small><a href="#part-3"><em> page 3, line 8<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-3"><em> page 3, line 4<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   over-(D)TLS traffic by dropping outgoing packets to destination port</td><td> </td><td class="right">   over-(D)TLS traffic by dropping outgoing packets to destination port</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   853, and by identifying the domains offering DNS-over-HTTPS servers,</td><td> </td><td class="right">   853, and by identifying the domains offering DNS-over-HTTPS servers,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   DNS-over-HTTPS traffic can be blocked by dropping outgoing packets to</td><td> </td><td class="right">   DNS-over-HTTPS traffic can be blocked by dropping outgoing packets to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   these domains.  If the endpoint has enabled strict privacy profile</td><td> </td><td class="right">   these domains.  If the endpoint has enabled strict privacy profile</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 5 of [RFC8310]), and the network security service blocks the</td><td> </td><td class="right">   (Section 5 of [RFC8310]), and the network security service blocks the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   traffic to the public DNS server, DNS service is not available to the</td><td> </td><td class="right">   traffic to the public DNS server, DNS service is not available to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint and ultimately the endpoint cannot access Internet.  If the</td><td> </td><td class="right">   endpoint and ultimately the endpoint cannot access Internet.  If the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint has enabled opportunistic privacy profile (Section 5 of</td><td> </td><td class="right">   endpoint has enabled opportunistic privacy profile (Section 5 of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8310]), and the network security service blocks traffic to the</td><td> </td><td class="right">   [RFC8310]), and the network security service blocks traffic to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   public DNS server, the endpoint will either fallback to an encrypted</td><td> </td><td class="right">   public DNS server, the endpoint will either fallback to an encrypted</td><td class="lineno"></td></tr>
      <tr id="diff0004"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection without authenticating the DNS-over-(D)TLS <span class="delete">and DNS-over-</span></td><td> </td><td class="rblock">   connection without authenticating the DNS-over-(D)TLS <span class="insert">server</span> provided</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   HTTPS servers</span> provided by the local network or fallback to clear text</td><td> </td><td class="rblock">   by the local network or fallback to clear text DNS, and cannot</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DNS, and cannot exchange encrypted DNS messages.  This can compromise</td><td> </td><td class="rblock">   exchange encrypted DNS messages.  This can compromise the endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the endpoint security and privacy; some of the potential security</td><td> </td><td class="rblock">   security and privacy; some of the potential security threats are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   threats are listed below:</td><td> </td><td class="rblock">   listed below:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Pervasive monitoring of DNS traffic.</td><td> </td><td class="right">   o  Pervasive monitoring of DNS traffic.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  If the endpoint is an IoT device which is configured to use public</td><td> </td><td class="right">   o  If the endpoint is an IoT device which is configured to use public</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      DNS-over-(D)TLS or DNS-over-HTTPS servers, and if a policy</td><td> </td><td class="right">      DNS-over-(D)TLS or DNS-over-HTTPS servers, and if a policy</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      enforcement point in the local network is programmed using a</td><td> </td><td class="right">      enforcement point in the local network is programmed using a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Manufacturer Usage Description (MUD) file [I-D.ietf-opsawg-mud] by</td><td> </td><td class="right">      Manufacturer Usage Description (MUD) file [I-D.ietf-opsawg-mud] by</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      a MUD manager to only allow intented communications to and from</td><td> </td><td class="right">      a MUD manager to only allow intented communications to and from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the IoT device, the policy enforcement point cannot enforce the</td><td> </td><td class="right">      the IoT device, the policy enforcement point cannot enforce the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Network Access Control List rules based on domain names (Section 8</td><td> </td><td class="right">      Network Access Control List rules based on domain names (Section 8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-4" class="change"><td></td><th><small>skipping to change at</small><a href="#part-4"><em> page 3, line 38<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-4"><em> page 3, line 34<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">      endpoint.  For instance, malwares like DNSChanger can modify the</td><td> </td><td class="right">      endpoint.  For instance, malwares like DNSChanger can modify the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      endpoint's DNS entries to point toward its own rogue name servers</td><td> </td><td class="right">      endpoint's DNS entries to point toward its own rogue name servers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      which then injected its own advertising into Web pages.</td><td> </td><td class="right">      which then injected its own advertising into Web pages.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The DPRIVE and DoH working groups have not defined an automated</td><td> </td><td class="right">   The DPRIVE and DoH working groups have not defined an automated</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   mechanism to securely bootstrap the endpoints to discover and</td><td> </td><td class="right">   mechanism to securely bootstrap the endpoints to discover and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticate DNS-over-(D)TLS and DNS-over-HTTPS servers in the local</td><td> </td><td class="right">   authenticate DNS-over-(D)TLS and DNS-over-HTTPS servers in the local</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   network.  Some clients have pre-configured specific public DNS</td><td> </td><td class="right">   network.  Some clients have pre-configured specific public DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   servers (such as Mozilla using Cloudflare's DNS-over-HTTPS server).</td><td> </td><td class="right">   servers (such as Mozilla using Cloudflare's DNS-over-HTTPS server).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If endpoints continue to use hard-coded public DNS servers, this has</td><td> </td><td class="right">   If endpoints continue to use hard-coded public DNS servers, this has</td><td class="lineno"></td></tr>
      <tr id="diff0005"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a risk of relying on few centralized DNS services.  <span class="delete">Further,</span> Content</td><td> </td><td class="rblock">   a risk of relying on few centralized DNS services.  Content Delivery</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Delivery Networks (CDNs) that map traffic based on DNS may lose the</td><td> </td><td class="rblock">   Networks (CDNs) that map traffic based on DNS may lose the ability to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ability to direct end-user traffic to a nearby cluster in cases where</td><td> </td><td class="rblock">   direct end-user traffic to a nearby cluster in cases where a DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a DNS service is being used that is not affiliated with the local</td><td> </td><td class="rblock">   service is being used that is not affiliated with the local network</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   network and which does not send "EDNS Client Subnet" (ECS)</td><td> </td><td class="rblock">   and which does not send "EDNS Client Subnet" (ECS) information to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   information to the CDN's DNS authorities [CDN].</td><td> </td><td class="rblock">   CDN's DNS authorities [CDN].  <span class="insert">If a local DNS server is not used for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   DNS resolution, "Split DNS" [RFC2775] to use the special internal-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   only domain names in enterprise networks will not work, and ".local"</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and "home.arpa" names cannot be locally resolved in home networks.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The document proposes a mechanism to automatically bootstrap the</td><td> </td><td class="right">   The document proposes a mechanism to automatically bootstrap the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoints to discover and authenticate the DNS-over-(D)TLS and DNS-</td><td> </td><td class="right">   endpoints to discover and authenticate the DNS-over-(D)TLS and DNS-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   over-HTTPS servers provided by the local network.  The overall</td><td> </td><td class="right">   over-HTTPS servers provided by the local network.  The overall</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   procedure can be structured into the following steps:</td><td> </td><td class="right">   procedure can be structured into the following steps:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Bootstrapping phase (Section 3 and Section 4) is meant to</td><td> </td><td class="right">   o  Bootstrapping phase (Section 3 and Section 4) is meant to</td><td class="lineno"></td></tr>
      <tr id="diff0006"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      automatically <span class="delete">to automatically</span> bootstrap endpoints with local</td><td> </td><td class="rblock">      automatically bootstrap endpoints with local network's CA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      network's CA certificates and DNS server certificate.</td><td> </td><td class="rblock">      certificates and DNS server certificate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0007"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Discovery phase (Section 5) is meant to discover <span class="delete">an authentication</span></td><td> </td><td class="rblock">   o  Discovery phase (Section 5) is meant to discover the <span class="insert">privacy-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      domain (defined in [RFC8310]) to authenticate</span> the <span class="delete">privacy-enabling</span></td><td> </td><td class="rblock"><span class="insert">      enabling</span> protocols supported by the DNS server and usable DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      DNS server, the privacy-enabling</span> protocols supported by the DNS</td><td> </td><td class="rblock">      server IP <span class="insert">addresses and port numbers.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      server and usable DNS server IP <span class="delete">addresses.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Connection handshake and service invocation: The DNS client</td><td> </td><td class="right">   o  Connection handshake and service invocation: The DNS client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      initiates (D)TLS handshake with the DNS server learned in the</td><td> </td><td class="right">      initiates (D)TLS handshake with the DNS server learned in the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      discovery phase.  Furthermore, DNS client uses the credentials</td><td> </td><td class="right">      discovery phase.  Furthermore, DNS client uses the credentials</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      discovered during the bootstrapping phase to validate the server</td><td> </td><td class="right">      discovered during the bootstrapping phase to validate the server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      certificate.</td><td> </td><td class="right">      certificate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0008"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">This document uses the terms</span> defined in <span class="delete">[RFC8499].</span></td><td> </td><td class="rblock">   <span class="insert">Note: The strict and opportunistic privacy profiles as</span> defined in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC8310] only applies to DNS-over-(D)TLS protocols, there has been</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   no such distinction made for DNS-over-HTTPS protocol.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0009"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">2.  <span class="delete">Requirements Language</span></td><td> </td><td class="rblock">2.  <span class="insert">Terminology</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td> </td><td class="right">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   14 [RFC2119][RFC8174] when, and only when, they appear in all</td><td> </td><td class="right">   14 [RFC2119][RFC8174] when, and only when, they appear in all</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0010"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">(D)TLS is used for statements that apply to both Transport Layer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Security [RFC8446] and Datagram Transport Layer Security [RFC6347].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Specific terms are used for any statement that applies to either</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protocol alone.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This document uses the terms defined in [RFC8499].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.  Bootstrapping IoT Devices and CPE</td><td> </td><td class="right">3.  Bootstrapping IoT Devices and CPE</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The following steps discuss the mechanism to automatically bootstrap</td><td> </td><td class="right">   The following steps discuss the mechanism to automatically bootstrap</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IoT devices with local network's CA certificates and DNS server</td><td> </td><td class="right">   IoT devices with local network's CA certificates and DNS server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   certificate.  The below steps can also be used by CPE acting as DNS</td><td> </td><td class="right">   certificate.  The below steps can also be used by CPE acting as DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   forwarders to discover and authenticate DNS-over-(D)TLS and DNS-over-</td><td> </td><td class="right">   forwarders to discover and authenticate DNS-over-(D)TLS and DNS-over-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   HTTPS servers provided by the access networks.</td><td> </td><td class="right">   HTTPS servers provided by the access networks.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0011"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  <span class="delete">The IoT device can use</span> Bootstrapping Remote Secure Key</td><td> </td><td class="rblock">   o  Bootstrapping Remote Secure Key Infrastructures (BRSKI) <span class="insert">discussed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Infrastructures (BRSKI) discussed in</td><td> </td><td class="rblock"><span class="insert">      in [I-D.ietf-anima-bootstrapping-keyinfra] provides a solution for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      secure automated bootstrap of devices.  BRSKI specifies means to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      provision credentials on devices to be used to operationally</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      access networks.  In addition, BRSKI provides an automated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      mechanism for the bootstrap distribution of CA certificates from</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the EST server.  The IoT device can use BRSKI</span> discussed in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      [I-D.ietf-anima-bootstrapping-keyinfra] to automatically bootstrap</td><td> </td><td class="right">      [I-D.ietf-anima-bootstrapping-keyinfra] to automatically bootstrap</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      the IoT device using the IoT manufacturer provisioned X.509</td><td> </td><td class="right">      the IoT device using the IoT manufacturer provisioned X.509</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      certificate, in combination with a registrar provided by the local</td><td> </td><td class="right">      certificate, in combination with a registrar provided by the local</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      network and IoT device manufacturer's authorizing service (MASA).</td><td> </td><td class="right">      network and IoT device manufacturer's authorizing service (MASA).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      1.  The IoT device authenticates to the local network using the</td><td> </td><td class="right">      1.  The IoT device authenticates to the local network using the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          IoT manufacturer provisioned X.509 certificate.  The IoT</td><td> </td><td class="right">          IoT manufacturer provisioned X.509 certificate.  The IoT</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          device can request and get a voucher from the MASA service via</td><td> </td><td class="right">          device can request and get a voucher from the MASA service via</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          the registrar.  The voucher is signed by the MASA service and</td><td> </td><td class="right">          the registrar.  The voucher is signed by the MASA service and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          includes the local network's CA public key.</td><td> </td><td class="right">          includes the local network's CA public key.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      2.  The IoT device validates the signed voucher using the</td><td> </td><td class="right">      2.  The IoT device validates the signed voucher using the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          manufacturer installed trust anchor associated with the MASA,</td><td> </td><td class="right">          manufacturer installed trust anchor associated with the MASA,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          stores the CA's public key and validates the provisional TLS</td><td> </td><td class="right">          stores the CA's public key and validates the provisional TLS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          connection to the registrar.</td><td> </td><td class="right">          connection to the registrar.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      3.  The IoT device requests the full Enrollment over Secure</td><td> </td><td class="right">      3.  The IoT device requests the full Enrollment over Secure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          Transport (EST) [RFC7030] distribution of current CA</td><td> </td><td class="right">          Transport (EST) [RFC7030] distribution of current CA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          certificates (Section 5.9.1 in</td><td> </td><td class="right">          certificates (Section 5.9.1 in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          [I-D.ietf-anima-bootstrapping-keyinfra]) from the registrar</td><td> </td><td class="right">          [I-D.ietf-anima-bootstrapping-keyinfra]) from the registrar</td><td class="lineno"></td></tr>
      <tr id="diff0012"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          operating as a BRSKI-EST server.  The IoT device uses the</td><td> </td><td class="rblock">          operating as a BRSKI-EST server.  The IoT <span class="insert">devices stores the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          Explicit Trust Anchor database to validate the DNS server</td><td> </td><td class="rblock"><span class="insert">          CA certificates as Explicit Trust Anchor database entries.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          certificate.</td><td> </td><td class="rblock"><span class="insert">          The IoT</span> device uses the Explicit Trust Anchor database to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">          validate the DNS server certificate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      4.  TBD: The IoT device learns the End-Entity certificates</td><td> </td><td class="right">      4.  TBD: The IoT device learns the End-Entity certificates</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          [RFC8295] from the BRSKI-EST server.  The certificate</td><td> </td><td class="right">          [RFC8295] from the BRSKI-EST server.  The certificate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          provisioned to the DNS server in the local network will be</td><td> </td><td class="right">          provisioned to the DNS server in the local network will be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          treated as a End-Entity certificate.  The IoT device needs to</td><td> </td><td class="right">          treated as a End-Entity certificate.  The IoT device needs to</td><td class="lineno"></td></tr>
      <tr id="diff0013"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          identify the End-Entity certificate <span class="delete">is</span> provisioned to the DNS</td><td> </td><td class="rblock">          identify the End-Entity certificate provisioned to the DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">          <span class="delete">server, the</span> key usage extension [RFC5280] can be used to</td><td> </td><td class="rblock">          <span class="insert">server.  The</span> key usage extension [RFC5280] can be used to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          restrict the use of the End-Entity certificate to authenticate</td><td> </td><td class="right">          restrict the use of the End-Entity certificate to authenticate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          the DNS server, a new bit will be added to the KeyUsage type</td><td> </td><td class="right">          the DNS server, a new bit will be added to the KeyUsage type</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">          to identify the DNS server certificate.</td><td> </td><td class="right">          to identify the DNS server certificate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.  Bootstrapping Endpoint Devices</td><td> </td><td class="right">4.  Bootstrapping Endpoint Devices</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The following steps explain the mechanism to automatically bootstrap</td><td> </td><td class="right">   The following steps explain the mechanism to automatically bootstrap</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   an endpoint with the local network's CA certificates and DNS server</td><td> </td><td class="right">   an endpoint with the local network's CA certificates and DNS server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   certificate:</td><td> </td><td class="right">   certificate:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   1.  The endpoint authenticates to the local network and establishes</td><td> </td><td class="right">   1.  The endpoint authenticates to the local network and establishes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       provisional TLS connection with the registrar operating as the</td><td> </td><td class="right">       provisional TLS connection with the registrar operating as the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       BRSKI-EST server.  The endpoint discovers registrar using DNS-</td><td> </td><td class="right">       BRSKI-EST server.  The endpoint discovers registrar using DNS-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       based Service Discovery [RFC6763].</td><td> </td><td class="right">       based Service Discovery [RFC6763].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   2.  The endpoint uses Salted Challenge Response Authentication</td><td> </td><td class="right">   2.  The endpoint uses Salted Challenge Response Authentication</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       Mechanism (SCRAM) [RFC7804] to perform mutual authentication with</td><td> </td><td class="right">       Mechanism (SCRAM) [RFC7804] to perform mutual authentication with</td><td class="lineno"></td></tr>
      <tr id="diff0014"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       the discovered BRSKI-EST server.</td><td> </td><td class="rblock">       the discovered BRSKI-EST server.  <span class="insert">SCRAM provides a more robust</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       authentication mechanism than a plaintext password protected by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Transport Layer Security (TLS).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   3.  If the BRSKI-EST server authentication is successful, the</td><td> </td><td class="right">   3.  If the BRSKI-EST server authentication is successful, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       endpoint requests the full EST distribution of current CA</td><td> </td><td class="right">       endpoint requests the full EST distribution of current CA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       certificates and validates the provisional TLS connection to the</td><td> </td><td class="right">       certificates and validates the provisional TLS connection to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       BRSKI-EST server.  If the BRSKI-EST server certificate cannot be</td><td> </td><td class="right">       BRSKI-EST server.  If the BRSKI-EST server certificate cannot be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       verified using the CA certificates downloaded, the TLS connection</td><td> </td><td class="right">       verified using the CA certificates downloaded, the TLS connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       is immediately discarded and the endpoint abandons the attempt to</td><td> </td><td class="right">       is immediately discarded and the endpoint abandons the attempt to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       bootstrap from the BRSKI-EST server and discards the CA</td><td> </td><td class="right">       bootstrap from the BRSKI-EST server and discards the CA</td><td class="lineno"></td></tr>
      <tr id="diff0015"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       certificates conveyed by the BRSKI-EST server.  The endpoint uses</td><td> </td><td class="rblock">       certificates conveyed by the BRSKI-EST server.  The endpoint</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       the Explicit Trust Anchor database to validate the DNS server</td><td> </td><td class="rblock">       <span class="insert">stores the CA certificates as Explicit Trust Anchor database</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       certificate.</td><td> </td><td class="rblock"><span class="insert">       entries.  The endpoint</span> uses the Explicit Trust Anchor database to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">       validate the DNS server certificate.  <span class="insert">The endpoint needs to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       perform SCRAM authentication the first time it connects BRSKI-EST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       server.  On subsequent connections to the BRSKI-EST server, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       endpoint can validate the BRSKI-EST server certificate using the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Explicit Trust Anchor Database.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   4.  TBD: The endpoint learns the End-Entity certificates [RFC8295]</td><td> </td><td class="right">   4.  TBD: The endpoint learns the End-Entity certificates [RFC8295]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       from the BRSKI-EST server.  The certificate provisioned to the</td><td> </td><td class="right">       from the BRSKI-EST server.  The certificate provisioned to the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       DNS server in the local network will be treated as a End-Entity</td><td> </td><td class="right">       DNS server in the local network will be treated as a End-Entity</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       certificate.  The endpoint needs to identify the End-Entity</td><td> </td><td class="right">       certificate.  The endpoint needs to identify the End-Entity</td><td class="lineno"></td></tr>
      <tr id="diff0016"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       certificate <span class="delete">is provisioned to the DNS server, t</span>he key usage</td><td> </td><td class="rblock">       certificate <span class="insert">provisioned to the DNS server.  T</span>he key usage</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       extension [RFC5280] can be used to restrict the use of the End-</td><td> </td><td class="right">       extension [RFC5280] can be used to restrict the use of the End-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       Entity certificate to authenticate the DNS server, a new bit will</td><td> </td><td class="right">       Entity certificate to authenticate the DNS server, a new bit will</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       be added to the KeyUsage type to identify the DNS server</td><td> </td><td class="right">       be added to the KeyUsage type to identify the DNS server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       certificate.</td><td> </td><td class="right">       certificate.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.  Discovery Procedure</td><td> </td><td class="right">5.  Discovery Procedure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A DNS client discovers the DNS server in the local network supporting</td><td> </td><td class="right">   A DNS client discovers the DNS server in the local network supporting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   DNS-over-TLS, DNS-over-DTLS and DNS-over-HTTPS protocols by using the</td><td> </td><td class="right">   DNS-over-TLS, DNS-over-DTLS and DNS-over-HTTPS protocols by using the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   following discovery mechanism:</td><td> </td><td class="right">   following discovery mechanism:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0017"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  The DNS client <span class="delete">uses DHCP to discover</span> the authentication domain</td><td> </td><td class="rblock">   o  The DNS client <span class="insert">retrieves</span> the authentication domain name for the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      name for the DNS <span class="delete">server, as specified in Section 5.1.</span></td><td> </td><td class="rblock">      DNS server <span class="insert">from</span> the <span class="insert">DNS-ID identifier</span> type <span class="insert">within subjectAltName</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"><span class="insert">      entry</span> in the DNS server <span class="insert">certificate.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  The DNS client then uses S-NAPTR [RFC3958] lookup to learn the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      protocols DNS-over-TLS, DNS-over-DTLS, and DNS-over-HTTPS</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      supported by the DNS</span> server <span class="delete">and the DNS privacy protocol preferred</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      by the DNS server administrators, as specified in Section 5.2 and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Section 7.3.1.  If DNS-over-HTTPS protocol is supported by</span> the <span class="delete">DNS</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      server, the DNS client queries for the URI resource record</span> type</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">[RFC7553] to use the https URI scheme (Section 3 of [RFC8484]).</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  The DNS client initiates (D)TLS handshake with the DNS server, the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      server presents its certificate and the client validates the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      server certificate using the End-Entity certificate and Explicit</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Trust Anchor database downloaded in steps 3 and 4</span> in <span class="delete">Section 3 and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Section 4.  The DNS client uses validation techniques as described</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      in [RFC6125] to compare</span> the <span class="delete">authentication domain name to the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      certificate provided by the DNS server.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  If the DNS client cannot reach or establish an authenticated and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      encrypted connection with the privacy-enabling</span> DNS server <span class="delete">provided</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      by the local network, the DNS client can fallback to the privacy-</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      enabling public DNS server.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.  DNS Reference Identifier DHCP Options</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   As reported in Section 1.7.2 of [RFC6125]:</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      "few certification authorities issue server certificates based on</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      IP addresses, but preliminary evidence indicates that such</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      certificates are a very small percentage (less than 1%) of issued</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      certificates".</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   In order to allow for certificate authentication between a DNS client</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and server while accommodating for the current best practices for</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   issuing certificates, this document allows for configuring</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   authentication domain name to clients.  This name can be used as a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reference identifier for authentication purposes.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.1.  DHCPv6 DNS Reference Identifier Option</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.1.1.  Option Format</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The DHCPv6 DNS Reference Identifier option is used to configure an</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   authentication domain name.  The format of this option is shown in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Figure 1.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      |     OPTION_V6_AUTH_DOMAIN     |         Option-length         |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      |            authentication-domain-name (FQDN)                  |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      |                                                               |</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">             Figure 1: DHCPv6 DNS Reference Identifier option</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   The fields of the option shown in Figure 1 are as follows:</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Option-code: OPTION_V6_AUTH_DOMAIN (TBA1, see Section 7.1)</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Option-length: Length of the authentication-domain-name field in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      octets.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  authentication-domain-name: A fully qualified domain name of the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      DNS server.  This field is formatted as specified in Section 10 of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      [RFC8415].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.1.2.  DHCPv6 Client Behavior</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   DHCP clients MAY request options OPTION_V6_AUTH_DOMAIN as defined in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC8415], Sections 18.2.1, 18.2.2, 18.2.4, 18.2.5, 18.2.6, and 21.7.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   As a convenience to the reader, it is mentioned here that the DHCP</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   client includes the requested option code in the Option Request</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Option.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   If the DHCP client receives more than one instance of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   OPTION_V6_AUTH_DOMAIN option, it MUST use only the first instance of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that option.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0018"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.2.  DHCPv4</span> DNS <span class="delete">Reference Identifier Option</span></td><td> </td><td class="rblock">   <span class="insert">o  The</span> DNS <span class="insert">client then uses the authentication domain name for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      S-NAPTR [RFC3958] lookup to learn the protocols DNS-over-TLS, DNS-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      over-DTLS, and DNS-over-HTTPS supported by the DNS server and the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      DNS privacy protocol preferred by the DNS server administrators,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      as specified in Section 5.1 and Section 8.1.  This specification</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      adds a SRV service label "domain-s" for privacy- enabling DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      servers.  In the example below, for authentication domain name</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      'example.net', the resolution algorithm will result in the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      privacy-enabling protocols supported by the DNS server and usable</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      DNS server IP addresses and port numbers.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0019"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.2.1.  Option Format</span></td><td> </td><td class="rblock">      <span class="insert">example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IN NAPTR 100 10 "" DPRIVE:dns.tls  "" dns1.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IN NAPTR 200 10 "" DPRIVE:dns.dtls "" dns2.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0020"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The DHCPv4 DNS Reference Identifier option is used to configure an</span></td><td> </td><td class="rblock">      <span class="insert">dns1.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   authentication domain name.  The format of this option is illustrated</span></td><td> </td><td class="rblock"><span class="insert">      IN NAPTR 100 10 S DPRIVE:dns.tls "" _domain-s._tcp.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   in Figure 2.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0021"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">            <span class="delete">Code  Length   authentication domain name</span></td><td> </td><td class="rblock">      <span class="insert">dns2.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">           +-----+-----+-----+-----+-----+-----+-----+--</span></td><td> </td><td class="rblock"><span class="insert">      IN NAPTR 100 10 S DPRIVE:dns.udp "" _domain-s._udp.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">           |TBA2 |  n  |  s1 |  s2 |  s3 |  s4 | s5  |  ...</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">           +-----+-----+-----+-----+-----+-----+-----+--</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0022"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">The values s1, s2, s3, etc. represent the domain name labels in the</span></td><td> </td><td class="rblock">      <span class="insert">_domain-s._tcp.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     domain name encoding.</span></td><td> </td><td class="rblock"><span class="insert">      IN SRV   0 0 853 a.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0023"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">             <span class="delete">Figure 2: DHCPv4 DNS Reference Identifier option</span></td><td> </td><td class="rblock">      <span class="insert">_domain-s._udp.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IN SRV   0 0 853 a.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0024"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The fields of the option shown in Figure 2 are as follows:</span></td><td> </td><td class="rblock">      <span class="insert">a.example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IN A        192.0.2.1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      IN AAAA     2001:db8:8:4::2</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0025"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">o  Code: OPTION_V4_AUTH_DOMAIN (TBA2, see Section 7.2);</span></td><td> </td><td class="rblock">                                 <span class="insert">Figure 1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Length: Includes the length of the authentication domain name</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      field in octets; the maximum length is 255 octets.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   o  Authentication domain name: The domain name of the DNS server.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      This field is formatted as specified in Section 10 of [RFC8415].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0026"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.1.2.2.  DHCPv4 Client Behavior</span></td><td> </td><td class="rblock">   <span class="insert">o  If DNS-over-HTTPS protocol is supported by the DNS server, the DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      client queries for the URI resource record type [RFC7553] to use</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the https URI scheme (Section 3 of [RFC8484]).  In the example</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      below, for authentication domain name 'example.net' and DNS-over-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      HTTPS server at https://example.net/dns-query.  The following URI</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      resource records could be made available:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0027"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">To discover a authentication domain name, the DHCPv4 client MUST</span></td><td> </td><td class="rblock">      <span class="insert">$ORIGIN example.net.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   include OPTION_V4_AUTH_DOMAIN in a Parameter Request List Option</span></td><td> </td><td class="rblock"><span class="insert">      _domain-s._tcp    IN URI 10 1 "https://example.net/dns-query"</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC2132].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0028"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If the DHCP client receives more than one instance of</span></td><td> </td><td class="rblock">                                 <span class="insert">Figure 2</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   OPTION_V4_AUTH_DOMAIN option, it MUST use only the first instance of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   that option.  The content of OPTION_V4_AUTH_DOMAIN is used as</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reference identifier for authentication purposes.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0029"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">5.<span class="delete">2</span>.  Resolution</td><td> </td><td class="rblock">5.<span class="insert">1</span>.  Resolution</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Once the DNS client has retrieved the authentication domain name for</td><td> </td><td class="right">   Once the DNS client has retrieved the authentication domain name for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the DNS server, an S-NAPTR lookup with 'DPRIVE' application service</td><td> </td><td class="right">   the DNS server, an S-NAPTR lookup with 'DPRIVE' application service</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and the desired protocol tag is made to obtain information necessary</td><td> </td><td class="right">   and the desired protocol tag is made to obtain information necessary</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to securely connect to the DNS server.  The S-NAPTR lookup is</td><td> </td><td class="right">   to securely connect to the DNS server.  The S-NAPTR lookup is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   performed using an untrusted recursive DNS resolver from an untrusted</td><td> </td><td class="right">   performed using an untrusted recursive DNS resolver from an untrusted</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   source (such as DHCP).</td><td> </td><td class="right">   source (such as DHCP).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This specification defines "DPRIVE" as an application service tag</td><td> </td><td class="right">   This specification defines "DPRIVE" as an application service tag</td><td class="lineno"></td></tr>
      <tr id="diff0030"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (Section <span class="delete">7.3.1)</span> and "dns.tls" (Section <span class="delete">7.3.2),</span> "dns.dtls"</td><td> </td><td class="rblock">   (Section <span class="insert">8.1.1)</span> and "dns.tls" (Section <span class="insert">8.1.2),</span> "dns.dtls"</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (Section <span class="delete">7.3.3),</span> and "dns.https" (Section <span class="delete">7.3.4)</span> as application</td><td> </td><td class="rblock">   (Section <span class="insert">8.1.3),</span> and "dns.https" (Section <span class="insert">8.1.4)</span> as application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protocol tags.</td><td> </td><td class="right">   protocol tags.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If no DNS-specific S-NAPTR records can be retrieved, the discovery</td><td> </td><td class="right">   If no DNS-specific S-NAPTR records can be retrieved, the discovery</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   procedure fails for this authentication domain name.  However, before</td><td> </td><td class="right">   procedure fails for this authentication domain name.  However, before</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   retrying a lookup that has failed, a DNS client MUST wait a time</td><td> </td><td class="right">   retrying a lookup that has failed, a DNS client MUST wait a time</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   period that is appropriate for the encountered error (e.g., NXDOMAIN,</td><td> </td><td class="right">   period that is appropriate for the encountered error (e.g., NXDOMAIN,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   timeout, etc.).</td><td> </td><td class="right">   timeout, etc.).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0031"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">6.  Security Considerations</td><td> </td><td class="rblock">6.  <span class="insert">Connection handshake and service invocation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The DNS client initiates (D)TLS handshake with the DNS server, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server presents its certificate in ServerHello message, and the DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client matches the DNS server certificate downloaded in step 4 in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 3 and Section 4 with the certificate provided by the DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server in (D)TLS handshake.  If the match is successful, the DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client then validates the server certificate using the Explicit Trust</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Anchor database entries downloaded in step 3 in Section 3 and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 4.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If the match is successful and server certificate is successfully</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   validated, the client continues with the connection as normal.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Otherwise, the client MUST treat the server certificate validation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   failure as a non-recoverable error.  If the DNS client cannot reach</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or establish an authenticated and encrypted connection with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   privacy-enabling DNS server provided by the local network, the DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client can fallback to the privacy-enabling public DNS server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7.</span>  Security Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The bootstrapping procedure to discover and authenticate DNS-</td><td> </td><td class="right">   The bootstrapping procedure to discover and authenticate DNS-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   over-(D)TLS and DNS-over-HTTPS Servers MUST be enabled by the</td><td> </td><td class="right">   over-(D)TLS and DNS-over-HTTPS Servers MUST be enabled by the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   endpoint in a trusted network (e.g.  Enterprise, Secure home</td><td> </td><td class="right">   endpoint in a trusted network (e.g.  Enterprise, Secure home</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   networks) and disabled in a untrusted network (e.g. public WiFi</td><td> </td><td class="right">   networks) and disabled in a untrusted network (e.g. public WiFi</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   network), similar to the way VPN connection from the endpoint to a</td><td> </td><td class="right">   network), similar to the way VPN connection from the endpoint to a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   VPN gateway is disconnected in a trusted network and VPN connection</td><td> </td><td class="right">   VPN gateway is disconnected in a trusted network and VPN connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is established in a untrusted network.</td><td> </td><td class="right">   is established in a untrusted network.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the endpoint has enabled strict privacy profile, and the network</td><td> </td><td class="right">   If the endpoint has enabled strict privacy profile, and the network</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   security service blocks the traffic to the privacy-enabling public</td><td> </td><td class="right">   security service blocks the traffic to the privacy-enabling public</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   DNS server, a hard failure occurs and the user is notified.  The user</td><td> </td><td class="right">   DNS server, a hard failure occurs and the user is notified.  The user</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   has a choice to switch to another network or if the user trusts the</td><td> </td><td class="right">   has a choice to switch to another network or if the user trusts the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   network, the user can enable strict privacy profile with the DNS-</td><td> </td><td class="right">   network, the user can enable strict privacy profile with the DNS-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   over-(D)TLS or DNS-over-HTTPS server discovered in the network</td><td> </td><td class="right">   over-(D)TLS or DNS-over-HTTPS server discovered in the network</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   instead of downgrading to opportunistic privacy profile.</td><td> </td><td class="right">   instead of downgrading to opportunistic privacy profile.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0032"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The primary <span class="delete">attack</span> against the methods described in Section 5 <span class="delete">is one</span></td><td> </td><td class="rblock">   The primary <span class="insert">attacks</span> against the methods described in Section 5 <span class="insert">are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   that would lead to impersonation of a DNS <span class="delete">server.  An attacker could</span></td><td> </td><td class="rblock"><span class="insert">   the ones</span> that would lead to impersonation of a DNS <span class="insert">server and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attempt</span> to <span class="delete">compromise</span> the <span class="delete">DHCP discovery and S-NAPTR resolution.</span>  The</td><td> </td><td class="rblock"><span class="insert">   spoofing the DNS response</span> to <span class="insert">indicate that</span> the <span class="insert">DNS server does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">attack</span> is prevented by validating the certificate presented by the</td><td> </td><td class="rblock"><span class="insert">   support any privacy-enabling protocols.  To protect against DNS-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DNS server.  <span class="delete">DHCP-related security considerations are discussed in</span></td><td> </td><td class="rblock"><span class="insert">   vectored attacks, secured DNS (DNSSEC) can be used to ensure the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC2131] and [RFC8415].</span></td><td> </td><td class="rblock"><span class="insert">   validity of the DNS records received.</span>  The <span class="insert">explicit trust anchor</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   database entries downloaded in step 3 in Section 3 and Section 4 can</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   be used by the endpoint to validate the DNSSEC signature.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Impersonation of the DNS server</span> is prevented by validating the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   certificate presented by the DNS server.  <span class="insert">If the BRSKI-EST server</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   conveys the DNS server certificate, but the S-NAPTR lookup indicates</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that the DNS server does not support any privacy-enabling protocols,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the client can detect the DNS response is spoofed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Security considerations in [I-D.ietf-anima-bootstrapping-keyinfra]</td><td> </td><td class="right">   Security considerations in [I-D.ietf-anima-bootstrapping-keyinfra]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and [RFC7804] need to be taken into consideration.</td><td> </td><td class="right">   and [RFC7804] need to be taken into consideration.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0033"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.</span>  IANA Considerations</td><td> </td><td class="rblock"><span class="insert">8.</span>  IANA Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.1.  DHCPv6 Option</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   IANA is requested to assign the following new DHCPv6 Option Code in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the registry maintained in http://www.iana.org/assignments/</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   dhcpv6-parameters:</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                  Option Name Value</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                        --------------------- -----</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                        OPTION_V6_AUTH_DOMAIN TBA1</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.2.  DHCPv4 Option</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   IANA is requested to assign the following new DHCPv4 Option Code in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the registry maintained in http://www.iana.org/assignments/bootp-</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   dhcp-parameters/:</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0034"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">             <span class="delete">Option Name Value Data length          Meaning</span></td><td> </td><td class="rblock">   <span class="insert">IANA</span> is <span class="insert">requested to allocate the SRV service name of "domain-s" for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   --------------------- ----- -------------------- --------------------</span></td><td> </td><td class="rblock"><span class="insert">   DNS-over-(D)TLS and DNS-over-HTTPS.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   OPTION_V4_AUTH_DOMAIN TBA2  Variable; the        Includes the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                               maximum length</span> is    <span class="delete">authentication</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                               255 octets.          domain name.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0035"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3</span>.  Application Service &amp; Application Protocol Tags</td><td> </td><td class="rblock"><span class="insert">8.1</span>.  Application Service &amp; Application Protocol Tags</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document requests IANA to make the following allocations from</td><td> </td><td class="right">   This document requests IANA to make the following allocations from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the registry available at: https://www.iana.org/assignments/s-naptr-</td><td> </td><td class="right">   the registry available at: https://www.iana.org/assignments/s-naptr-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   parameters/s-naptr-parameters.xhtml.</td><td> </td><td class="right">   parameters/s-naptr-parameters.xhtml.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0036"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3</span>.1.  DNS Application Service Tag Registration</td><td> </td><td class="rblock"><span class="insert">8.1</span>.1.  DNS Application Service Tag Registration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Application Protocol Tag: DPRIVE</td><td> </td><td class="right">   o  Application Protocol Tag: DPRIVE</td><td class="lineno"></td></tr>
      <tr id="diff0037"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Intended Usage: See Section <span class="delete">5.2</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Security Considerations: See Section <span class="delete">6</span></td><td> </td><td class="rblock">   o  Intended Usage: See Section <span class="insert">5.1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   o  Security Considerations: See Section <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Contact Information: &lt;one of the authors&gt;</td><td> </td><td class="right">   o  Contact Information: &lt;one of the authors&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0038"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3</span>.2.  dns.tls Application Protocol Tag Registration</td><td> </td><td class="rblock"><span class="insert">8.1</span>.2.  dns.tls Application Protocol Tag Registration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Application Protocol Tag: dns.tls</td><td> </td><td class="right">   o  Application Protocol Tag: dns.tls</td><td class="lineno"></td></tr>
      <tr id="diff0039"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Intended Usage: See Section <span class="delete">5.2</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Security Considerations: See Section <span class="delete">6</span></td><td> </td><td class="rblock">   o  Intended Usage: See Section <span class="insert">5.1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   o  Security Considerations: See Section <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Contact Information: &lt;one of the authors&gt;</td><td> </td><td class="right">   o  Contact Information: &lt;one of the authors&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0040"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3</span>.3.  dns.dtls Application Protocol Tag Registration</td><td> </td><td class="rblock"><span class="insert">8.1</span>.3.  dns.dtls Application Protocol Tag Registration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Application Protocol Tag: dns.dtls</td><td> </td><td class="right">   o  Application Protocol Tag: dns.dtls</td><td class="lineno"></td></tr>
      <tr id="diff0041"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Intended Usage: See Section <span class="delete">5.2</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Security Considerations: See Section <span class="delete">6</span></td><td> </td><td class="rblock">   o  Intended Usage: See Section <span class="insert">5.1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   o  Security Considerations: See Section <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Contact Information: &lt;one of the authors&gt;</td><td> </td><td class="right">   o  Contact Information: &lt;one of the authors&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0042"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.3</span>.4.  dns.https Application Protocol Tag Registration</td><td> </td><td class="rblock"><span class="insert">8.1</span>.4.  dns.https Application Protocol Tag Registration</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Application Protocol Tag: dnshttps</td><td> </td><td class="right">   o  Application Protocol Tag: dnshttps</td><td class="lineno"></td></tr>
      <tr id="diff0043"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Intended Usage: See Section <span class="delete">5.2</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   o  Security Considerations: See Section <span class="delete">6</span></td><td> </td><td class="rblock">   o  Intended Usage: See Section <span class="insert">5.1</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   o  Security Considerations: See Section <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   o  Contact Information: &lt;one of the authors&gt;</td><td> </td><td class="right">   o  Contact Information: &lt;one of the authors&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0044"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">8</span>.  Acknowledgments</td><td> </td><td class="rblock"><span class="insert">9</span>.  Acknowledgments</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0045"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Thanks to Joe <span class="delete">Hildebrand</span> for <span class="delete">his comments</span> and <span class="delete">suggestions.</span></td><td> </td><td class="rblock">   Thanks to Joe <span class="insert">Hildebrand, Harsha Joshi, Patrick McManus and Sara</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Dickinson</span> for <span class="insert">the discussion</span> and <span class="insert">comments.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0046"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">9</span>.  References</td><td> </td><td class="rblock"><span class="insert">10</span>.  References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0047"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">9</span>.1.  Normative References</td><td> </td><td class="rblock"><span class="insert">10</span>.1.  Normative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [I-D.ietf-anima-bootstrapping-keyinfra]</td><td> </td><td class="right">   [I-D.ietf-anima-bootstrapping-keyinfra]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Pritikin, M., Richardson, M., Behringer, M., Bjarnason,</td><td> </td><td class="right">              Pritikin, M., Richardson, M., Behringer, M., Bjarnason,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              S., and K. Watsen, "Bootstrapping Remote Secure Key</td><td> </td><td class="right">              S., and K. Watsen, "Bootstrapping Remote Secure Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Infrastructures (BRSKI)", draft-ietf-anima-bootstrapping-</td><td> </td><td class="right">              Infrastructures (BRSKI)", draft-ietf-anima-bootstrapping-</td><td class="lineno"></td></tr>
      <tr id="diff0048"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              keyinfra-1<span class="delete">8 (work in progress), January</span> 2019.</td><td> </td><td class="rblock">              keyinfra-1<span class="insert">9 (work in progress), March</span> 2019.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Requirement Levels", BCP 14, RFC 2119,</td><td> </td><td class="right">              Requirement Levels", BCP 14, RFC 2119,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC2119, March 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2119, March 1997,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0049"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[RFC2131]  Droms, R., "Dynamic Host Configuration Protocol",</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              RFC 2131, DOI 10.17487/RFC2131, March 1997,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc2131&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC2132]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Extensions", RFC 2132, DOI 10.17487/RFC2132, March 1997,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc2132&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC3958]  Daigle, L. and A. Newton, "Domain-Based Application</td><td> </td><td class="right">   [RFC3958]  Daigle, L. and A. Newton, "Domain-Based Application</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Service Location Using SRV RRs and the Dynamic Delegation</td><td> </td><td class="right">              Service Location Using SRV RRs and the Dynamic Delegation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Discovery Service (DDDS)", RFC 3958, DOI 10.17487/RFC3958,</td><td> </td><td class="right">              Discovery Service (DDDS)", RFC 3958, DOI 10.17487/RFC3958,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              January 2005, &lt;https://www.rfc-editor.org/info/rfc3958&gt;.</td><td> </td><td class="right">              January 2005, &lt;https://www.rfc-editor.org/info/rfc3958&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,</td><td> </td><td class="right">   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Housley, R., and W. Polk, "Internet X.509 Public Key</td><td> </td><td class="right">              Housley, R., and W. Polk, "Internet X.509 Public Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Infrastructure Certificate and Certificate Revocation List</td><td> </td><td class="right">              Infrastructure Certificate and Certificate Revocation List</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,</td><td> </td><td class="right">              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc5280&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc5280&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6125]  Saint-Andre, P. and J. Hodges, "Representation and</td><td> </td><td class="right">   [RFC6125]  Saint-Andre, P. and J. Hodges, "Representation and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Verification of Domain-Based Application Service Identity</td><td> </td><td class="right">              Verification of Domain-Based Application Service Identity</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              within Internet Public Key Infrastructure Using X.509</td><td> </td><td class="right">              within Internet Public Key Infrastructure Using X.509</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (PKIX) Certificates in the Context of Transport Layer</td><td> </td><td class="right">              (PKIX) Certificates in the Context of Transport Layer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Security (TLS)", RFC 6125, DOI 10.17487/RFC6125, March</td><td> </td><td class="right">              Security (TLS)", RFC 6125, DOI 10.17487/RFC6125, March</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2011, &lt;https://www.rfc-editor.org/info/rfc6125&gt;.</td><td> </td><td class="right">              2011, &lt;https://www.rfc-editor.org/info/rfc6125&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0050"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC6347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Security Version 1.2", RFC 6347, DOI 10.17487/RFC6347,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              January 2012, &lt;https://www.rfc-editor.org/info/rfc6347&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6763]  Cheshire, S. and M. Krochmal, "DNS-Based Service</td><td> </td><td class="right">   [RFC6763]  Cheshire, S. and M. Krochmal, "DNS-Based Service</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Discovery", RFC 6763, DOI 10.17487/RFC6763, February 2013,</td><td> </td><td class="right">              Discovery", RFC 6763, DOI 10.17487/RFC6763, February 2013,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6763&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6763&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC7030]  Pritikin, M., Ed., Yee, P., Ed., and D. Harkins, Ed.,</td><td> </td><td class="right">   [RFC7030]  Pritikin, M., Ed., Yee, P., Ed., and D. Harkins, Ed.,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              "Enrollment over Secure Transport", RFC 7030,</td><td> </td><td class="right">              "Enrollment over Secure Transport", RFC 7030,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC7030, October 2013,</td><td> </td><td class="right">              DOI 10.17487/RFC7030, October 2013,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc7030&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc7030&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC7553]  Faltstrom, P. and O. Kolkman, "The Uniform Resource</td><td> </td><td class="right">   [RFC7553]  Faltstrom, P. and O. Kolkman, "The Uniform Resource</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-5" class="change"><td></td><th><small>skipping to change at</small><a href="#part-5"><em> page 12, line 41<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-5"><em> page 12, line 5<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8094&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8094&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td> </td><td class="right">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td> </td><td class="right">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td> </td><td class="right">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8295]  Turner, S., "EST (Enrollment over Secure Transport)</td><td> </td><td class="right">   [RFC8295]  Turner, S., "EST (Enrollment over Secure Transport)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Extensions", RFC 8295, DOI 10.17487/RFC8295, January 2018,</td><td> </td><td class="right">              Extensions", RFC 8295, DOI 10.17487/RFC8295, January 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8295&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8295&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0051"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[RFC8415]  Mrugalski, T., Siodelski, M., Volz, B., Yourtchenko, A.,</span></td><td> </td><td class="rblock">   <span class="insert">[RFC8446]  Rescorla, E., "The Transport Layer Security (TLS)</span> Protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Richardson, M., Jiang, S., Lemon, T., and T. Winters,</span></td><td> </td><td class="rblock">              <span class="insert">Version 1.3",</span> RFC <span class="insert">8446,</span> DOI <span class="insert">10.17487/RFC8446, August</span> 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              "Dynamic Host Configuration</span> Protocol <span class="delete">for IPv6 (DHCPv6)",</span></td><td> </td><td class="rblock">              <span class="insert">&lt;https://www.rfc-editor.org/info/rfc8446&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              RFC <span class="delete">8415,</span> DOI <span class="delete">10.17487/RFC8415, November</span> 2018,</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">&lt;https://www.rfc-editor.org/info/rfc8415&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8484]  Hoffman, P. and P. McManus, "DNS Queries over HTTPS</td><td> </td><td class="right">   [RFC8484]  Hoffman, P. and P. McManus, "DNS Queries over HTTPS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (DoH)", RFC 8484, DOI 10.17487/RFC8484, October 2018,</td><td> </td><td class="right">              (DoH)", RFC 8484, DOI 10.17487/RFC8484, October 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8484&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8484&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0052"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">9.2.</span>  Informative References</td><td> </td><td class="rblock">   <span class="insert">[RFC8499]  Hoffman, P., Sullivan, A., and K. Fujiwara, "DNS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Terminology", BCP 219, RFC 8499, DOI 10.17487/RFC8499,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              January 2019, &lt;https://www.rfc-editor.org/info/rfc8499&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">10.2.</span>  Informative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [CDN]      "End-User Mapping: Next Generation Request Routing for</td><td> </td><td class="right">   [CDN]      "End-User Mapping: Next Generation Request Routing for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Content Delivery", 2015,</td><td> </td><td class="right">              Content Delivery", 2015,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://conferences.sigcomm.org/sigcomm/2015/pdf/papers/</td><td> </td><td class="right">              &lt;https://conferences.sigcomm.org/sigcomm/2015/pdf/papers/</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              p167.pdf&gt;.</td><td> </td><td class="right">              p167.pdf&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [I-D.ietf-opsawg-mud]</td><td> </td><td class="right">   [I-D.ietf-opsawg-mud]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Lear, E., Droms, R., and D. Romascanu, "Manufacturer Usage</td><td> </td><td class="right">              Lear, E., Droms, R., and D. Romascanu, "Manufacturer Usage</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Description Specification", draft-ietf-opsawg-mud-25 (work</td><td> </td><td class="right">              Description Specification", draft-ietf-opsawg-mud-25 (work</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              in progress), June 2018.</td><td> </td><td class="right">              in progress), June 2018.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0053"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC2775]  Carpenter, B., "Internet Transparency", RFC 2775,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC2775, February 2000,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc2775&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8310]  Dickinson, S., Gillmor, D., and T. Reddy, "Usage Profiles</td><td> </td><td class="right">   [RFC8310]  Dickinson, S., Gillmor, D., and T. Reddy, "Usage Profiles</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              for DNS over TLS and DNS over DTLS", RFC 8310,</td><td> </td><td class="right">              for DNS over TLS and DNS over DTLS", RFC 8310,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC8310, March 2018,</td><td> </td><td class="right">              DOI 10.17487/RFC8310, March 2018,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8310&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8310&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0054"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[RFC8499]  Hoffman, P., Sullivan, A., and K. Fujiwara, "DNS</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Terminology", BCP 219, RFC 8499, DOI 10.17487/RFC8499,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              January 2019, &lt;https://www.rfc-editor.org/info/rfc8499&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Tirumaleswar Reddy</td><td> </td><td class="right">   Tirumaleswar Reddy</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   McAfee, Inc.</td><td> </td><td class="right">   McAfee, Inc.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Embassy Golf Link Business Park</td><td> </td><td class="right">   Embassy Golf Link Business Park</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Bangalore, Karnataka  560071</td><td> </td><td class="right">   Bangalore, Karnataka  560071</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   India</td><td> </td><td class="right">   India</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: kondtir@gmail.com</td><td> </td><td class="right">   Email: kondtir@gmail.com</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 54 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td></td><th><i>223 lines changed or deleted</i></th><th><i> </i></th><th><i>193 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" class="small" align="center"><br>This html diff was produced by rfcdiff 1.47. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/">http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </tbody></table>
   
   
</body></html>